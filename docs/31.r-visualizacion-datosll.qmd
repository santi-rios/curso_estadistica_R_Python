---
title: "Visualizaci칩n de Datos II"
subtitle: "Otras formas de visualizar la distribuci칩n de datos"
format: live-html
toc: true
sidebar: false
webr:
  packages:
  - datos
  - ggplot2
  - GGally
  - dplyr
execute: 
  warning: false
engine: knitr
---

{{< include ../_extensions/r-wasm/live/_knitr.qmd >}}

Adem치s de los histogramas, los cuales representan la distribuci칩n de una variable continua dividiendo los datos en intervalos, existen otras formas de visualizar la distribuci칩n de datos. Dependiendo de la naturaleza de los datos y el objetivo de la visualizaci칩n, es posible utilizar distintos gr치ficos para explorar y comunicar patrones en los datos. 


## Introducci칩n

- Para esta lecci칩n, seguiremos utilizando el paquete `ggplot2` en R para crear visualizaciones avanzadas de datos.
- Usaremos el juego de datos `pinguinos` que utilizamos en el [m칩dulo pasado](https://riverorca.com/mod/hvp/view.php?id=238), que contiene informaci칩n sobre tres especies de ping칲inos: Adelia, Pap칰a y Barbijo. 
- Primero, carguemos las librer칤as necesarias y exploremos el conjunto de datos.

```{webr}
#| edit: false
#| runbutton: false

# Cargar paquete necesario
library(ggplot2)
library(datos)


# Explorar el conjunto de datos
str(pinguinos)

```


El conjunto de datos pinguinos contiene las siguientes variables:

| Variable Name   |  Description
|:----------------|:--------------------------------
| `especie` | Especie de ping칲ino
| `isla` | Isla donde se encontr칩 el ping칲ino
| `largo_pico_mm` | Longitud del pico en mil칤metros
| `alto_pico_mm` | Profundidad del pico en mil칤metros
| `largo_aleta_mm` | Longitud de la aleta en mil칤metros
| `masa_corporal_g` | Masa corporal en gramos
| `sexo` | Sexo del ping칲ino
| `anio` | A침o de la medici칩n


::: {.callout-tip}
## Definir un tema global para ggplot

- Como ya vimos, podemos usar temas de ggplot para personalizar la apariencia de nuestros gr치ficos.
- Para no tener que estar especificando el tema en cada gr치fico, podemos definir un tema global que se aplique a todos los gr치ficos que creemos.
- Adem치s, esto nos permite mantener la consistencia en la apariencia de nuestros gr치ficos.
- Para esto, usamos la funci칩n `theme_set()` y especificamos el tema que queremos aplicar. Por ejemplo, vamos a aplicar el tema cl치sico a todos nuestros gr치ficos con este c칩digo (el c칩digo se ejecuta autom치ticamente al cargar esta p치gina):

```{webr}
#| edit: false
#| runbutton: false

# Definir un tema global para ggplot
theme_set(theme_classic())
```

- Puedes conocer m치s sobre los temas de ggplot en la [este enlace](https://r-charts.com/ggplot2/themes/).

:::

## Histogramas y gr치ficos de densidad

- Recordemos c칩mo hacer un histogramas, los cuales son una forma com칰n de visualizar la distribuci칩n de una variable continua.
- A continuaci칩n, crearemos un histograma de la masa corporal de los ping칲inos.

```{webr}
#| warning: false

ggplot(pinguinos, aes(x = masa_corporal_g)) +
  geom_histogram() +
  labs(title = "Distribuci칩n de Masa Corporal",      
       x = "Masa (g)", y = "Frecuencia")
```

- La mayor칤a de las veces, nos interesa ver c칩mo se distribuyen los datos en funci칩n de una variable categ칩rica.
- Por ejemplo, podemos querer comparar la distribuci칩n de la masa corporal de los ping칲inos en cada una de las 3 especies del juego de datos.
- Para esto, podemos usar la funci칩n de ggplot `facet_grid()` para dividir el gr치fico en paneles seg칰n la variable categ칩rica `especie`. Observa que utilizamos el operador `~` para indicar que queremos dividir el gr치fico por la variable `especie`.

```{webr}
#| warning: false

ggplot(pinguinos, aes(x = masa_corporal_g)) +
  geom_histogram() +
  labs(title = "Distribuci칩n de Masa Corporal",      
       x = "Masa (g)", y = "Frecuencia") +
  facet_grid(~ especie)
```

- Otra forma de visualizar la distribuci칩n de una variable continua es mediante un ***gr치fico de densidad***.
- Estos gr치ficos son similares a los histogramas, pero en lugar de dividir los datos en intervalos, muestran la distribuci칩n de los datos como una curva suave.
- En estos gr치ficos, en lugar de representar la frecuencia de los datos, se muestra la densidad de probabilidad de los datos. El 치rea bajo la curva es igual a 1 ya que representa la probabilidad total de los datos.
- Ahora, en lugar de usar la funci칩n `geom_histogram()`, usaremos la funci칩n `geom_density()` para crear un gr치fico de densidad de la masa corporal de los ping칲inos.


```{webr}
#| warning: false

ggplot(pinguinos, aes(x = masa_corporal_g)) +
  geom_density() + # Gr치fico de densidad
  labs(title = "Distribuci칩n de Masa Corporal",  
       caption = "Se grafican todas las especies juntas",       
       x = "Masa (g)", y = "Frecuencia") 
```

- En este tipo de gr치ficos, podemos decirle a ggplot que divida los datos en funci칩n de una variable categ칩rica, de manera similar a lo que hicimos con los histogramas.
- Podr칤amos usar de nuevo la funci칩n `facet_grid()` para dividir el gr치fico en paneles seg칰n la variable categ칩rica `especie`. Sin embargo, en este caso, usaremos la funci칩n `fill` para colorear las curvas de densidad seg칰n la variable categ칩rica `especie`.
- En este caso, no vamos a dividir el gr치fico en paneles, sino que vamos a superponer las curvas de densidad de las tres especies de ping칲inos en un solo gr치fico para compararlas facilmente. Para facilitar la comparaci칩n, observa que pasamos el argumento `alpha = 0.5` a la funci칩n `geom_density()` para hacer las curvas semitransparentes. `alpha` controla la transparencia de los elementos del gr치fico, con 0 siendo completamente transparente y 1 siendo completamente opaco.


```{webr}
#| warning: false

ggplot(pinguinos, aes(x = masa_corporal_g, fill = especie)) + # fill
  geom_density(alpha = 0.5) + # alpha
  labs(title = "Distribuci칩n de Masa Corporal",  
       caption = "Se grafican todas las especies juntas",       
       x = "Masa (g)", y = "Frecuencia") 
```


**Comparaci칩n entre geom_histogram() y geom_density()**

| **Caracter칤stica**       | **geom_histogram()**                                         | **geom_density()**                                         |
|--------------------------|--------------------------------------------------------------|------------------------------------------------------------|
| **Tipo de gr치fico**       | Barras que muestran la frecuencia de los datos en intervalos | Curva suave de densidad de probabilidad                    |
| **Representaci칩n**        | Frecuencia absoluta (o densidad si se normaliza) por intervalo | Densidad de probabilidad continua                          |
| **Ajuste o suavizado**    | Depende del n칰mero de bins o del ancho de los bins           | Estimador de densidad kernel (KDE)    |
| **Flexibilidad**          | Depende de la elecci칩n de los bins                           | M치s flexible y suave, no depende de intervalos             |
| **Interpretaci칩n**        | Frecuencia de los datos en grupos espec칤ficos                | Tendencia general de la distribuci칩n de los datos          |


### Tips para graficar histogramas y densidades

#### Sobreponer histograma y densidad

- En ocasiones, es 칰til superponer un histograma y una gr치fica de densidad para comparar la distribuci칩n de los datos de manera m치s efectiva. 
- Esto puede ayudarte a visualizar la forma de la distribuci칩n y c칩mo se ajusta la densidad a los datos observados en el histograma. 
- Para hacer esto, simplemente agregamos las dos capas al gr치fico utilizando `geom_histogram()` y `geom_density()`.
- Observa que usamos el argumento `aes(y = ..density..)` en `geom_histogram()`. Esto es para normalizar el histograma, de manera que su altura sea comparable con la curva de densidad generada por geom_density(). Es decir, en lugar de mostrar la frecuencia absoluta (n칰mero de observaciones en cada intervalo), normalizamos el histograma para que la suma de las alturas de las barras sea igual a 1, lo que permite comparar la forma de la distribuci칩n con la curva de densidad.
- Otro argumento nuevo que aparece en este c칩digo es `position = "identity` dentro de `geom_histogram()`. Este argumento especifica c칩mo se deben posicionar los elementos gr치ficos (como barras, puntos, l칤neas, etc.) cuando hay superposici칩n de datos. El argumento position = "identity" le dice a ggplot2 que no ajuste la posici칩n de los elementos gr치ficos y que los dibuje en su ubicaci칩n original, es decir, en el mismo lugar donde los datos pertenecen. Esto es especialmente 칰til cuando quieres superponer varias capas de gr치ficos, como un histograma y una curva de densidad, o cuando est치s comparando varias categor칤as en un mismo gr치fico. Cuando tienes m칰ltiples grupos o categor칤as, por defecto, ggplot2 trata de ajustar la posici칩n de los elementos gr치ficos para que no se superpongan completamente. 
- Otros argumentos de posici칩n son: "stack" (apila los elementos), "dodge" (distribuye los elementos uno al lado del otro), "fill" (apila los elementos y los rellena), "jitter" (agrega un poco de ruido a los elementos para evitar la superposici칩n), entre otros. Algunos de estos ejemplos ir치n apareciendo en lecciones futuras.

```{webr}
#| warning: false

# Crear un histograma y una densidad superpuestos
ggplot(pinguinos, aes(x = masa_corporal_g, fill = especie)) +
  geom_histogram(aes(y = ..density..), alpha = 0.5, position = "identity") +
  geom_density(alpha = 0.3) +
  labs(title = "Distribuci칩n de Masa Corporal",         
       x = "Masa (g)", y = "Densidad")

```

#### Visualizar la media en un histograma

- En ocasiones, es 칰til visualizar la media de una variable en un histograma para tener una idea de la ubicaci칩n central de los datos.
- Para hacer esto, podemos agregar una l칤nea vertical al histograma que represente la media de los datos.
- En el siguiente c칩digo, calculamos la media de la masa corporal de los ping칲inos y la agregamos al histograma utilizando la funci칩n `geom_vline()`.
- Observa que `geom_vline()` tiene los siguientes argumentos: `xintercept` (la posici칩n en el eje x donde se dibujar치 la l칤nea vertical), `color` (el color de la l칤nea), `linetype` (el tipo de l칤nea, puede ser "solid", "dashed", "dotted", entre otros) y `size` (el grosor de la l칤nea). 
- El argumento `aes(xintercept = mean(masa_corporal_g, na.rm = TRUE))` calcula directamente la media de `masa_corporal_g` dentro de ggplot. El par치metro `na.rm = TRUE` asegura que se ignoren los valores faltantes (NA).

```{webr}
#| warning: false

ggplot(pinguinos, aes(x = masa_corporal_g)) +
  geom_histogram() +
  geom_vline(aes(xintercept = mean(masa_corporal_g, na.rm = TRUE)), 
             color = "red", linetype = "dashed", size = 1) +
  labs(title = "Distribuci칩n de Masa Corporal",         
       x = "Masa (g)", y = "Frecuencia")

```

## Boxplots y Violin Plots

### Boxplots

- Los boxplots y los violin plots son gr치ficos que permiten visualizar la distribuci칩n de una variable continua en funci칩n de una variable categ칩rica.
- Los boxplots son gr치ficos que muestran la distribuci칩n de los datos a trav칠s de sus cuartiles y resaltan valores at칤picos.
- **Cuartil**: Un cuartil es un valor que divide un conjunto de datos ordenados en cuatro partes iguales. El primer cuartil (Q1) es el valor que deja el 25% de los datos por debajo, el segundo cuartil (Q2) es la mediana y el tercer cuartil (Q3) es el valor que deja el 75% de los datos por debajo. En una distribuci칩n normal, la mediana es igual a Q2.
- **Valor at칤pico**: Un valor at칤pico es un valor que es significativamente diferente del resto de los datos en un conjunto. En un boxplot, los valores at칤picos se representan como puntos individuales fuera de los "bigotes" del gr치fico. Estos puntos, tambi칠n llamados *outliers*, son valores que caen fuera de 1.5 veces el rango intercuart칤lico (IQR) por encima del tercer cuartil o por debajo del primer cuartil y pueden ser indicativos de errores en los datos o de fen칩menos inusuales. Dependiendo del contexto, los valores at칤picos pueden ser eliminados, transformados o analizados en detalle.

![](https://r-graph-gallery.com/img/other/boxplot_explanation.png)

- **Mediana**: La l칤nea dentro de la caja representa la mediana de la distribuci칩n.
- **Cuartiles**: Los extremos de la caja muestran el primer cuartil (Q1) y el tercer cuartil (Q3), es decir, el 25% y el 75% de los datos.
- **Rango intercuart칤lico (IQR)**: Es el rango entre Q1 y Q3, y la longitud de la caja representa este rango.
- **Bigotes** (whiskers): Se extienden hasta 1.5 veces el IQR desde los cuartiles. M치s all치 de estos bigotes, los puntos se consideran valores at칤picos.
- Valores at칤picos (**outliers**): Los puntos individuales que caen fuera de los bigotes se consideran at칤picos y se muestran como puntos.

- Para crear un boxplot en ggplot, usamos la funci칩n `geom_boxplot()`.
- Como vamos a ver la distribuci칩n de una variable cont칤nua (`masa_corporal_g`) en funci칩n de una variable categ칩rica (en este caso `especie`), usaremos `aes(x = especie, y = masa_corporal_g)` para mapear las variables al gr치fico.

```{webr}
#| warning: false

# Gr치fico de Cajas
ggplot(pinguinos, aes(x = especie, y = masa_corporal_g)) +
  geom_boxplot() +
  labs(title = "Boxplots de Masa Corporal",         
       x = "Especie", y = "Masa Corporal (g)") 
```

- Observa que la caja de nuestro boxplot se ve dividida en tres partes: la l칤nea en el medio de la caja representa la mediana. Como nuestros datos est치n distribu칤dos aproximadamente de manera normal, la mediana divide los datos en dos partes iguales. Si los datos no est치n distribu칤dos de manera normal, la mediana no necesariamente divide los datos en dos partes iguales.
- Adem치s, podemos ver la dispersi칩n de las masas en las 3 especies. Esta dispersi칩n se observa en la extensi칩n del del boxplot, que representan el rango de los datos. Por lo tanto, una variable con alta dispersi칩n tendr치 un boxplot m치s largo.
- Observa que la especie "Barbijo" tiene 2 valores at칤picos, representados como puntos individuales fuera de los "bigotes" del gr치fico.
- R치pidamente podemos ver que la especie Papua tiene una mediana de masa m치s alta que las otras dos especies. Sin embargo, esta no es una comparaci칩n formal de las medias. Para esto, necesitar칤amos realizar un an치lisis estad칤stico como una prueba t o un an치lisis de varianza (ANOVA) que se ver치n m치s adelante en el curso.


### Viol칤n

- Ahora, un gr치fico de viol칤n es una forma de visualizar la distribuci칩n de los datos que combina aspectos del boxplot y el gr치fico de densidad.
-  La forma del "viol칤n" muestra la densidad de los datos en varios puntos a lo largo del eje y, lo que permite ver d칩nde se encuentran la mayor칤a de los datos (zonas m치s anchas) y las zonas menos densas (zonas m치s estrechas).
-  Tambi칠n podemos ver la **simetr칤a** de nuestros datos: si el gr치fico de viol칤n es  sim칠trico, significa que tenemos aproximadamente la misma densidad en ambos lados.
-  A diferencia del boxplot, que solo muestra un resumen de los datos, el gr치fico de viol칤n te permite ver la forma completa de la distribuci칩n.

Puedes pensar en un gr치fico de viol칤n como un histograma girado 90 grados y reflejado a lo largo del eje y, por ejemplo:

![](https://wac-cdn.atlassian.com/dam/jcr:3eadd6ba-3f83-484b-ad28-8fed0f82c968/faceted-histogram-example.png?cdnVersion=2409)



```{webr}
#| warning: false

ggplot(pinguinos, aes(x = especie, y = masa_corporal_g)) +
  geom_violin() +
  labs(title = "Boxplots de Masa Corporal",         
       x = "Especie", y = "Masa Corporal (g)")
```


-  Adicionalmente, es una forma m치s visual de comparar la distribuci칩n de los datos entre diferentes categor칤as cuando tenemos muchos datos.
-  Por ejemplo, observa que es m치s f치cil comparar la distribuci칩n de la masa corporal entre las diferentes especies de ping칲inos divididos por isla y sexo en un solo gr치fico. En este caso, usamos `facet_grid(~ isla)` para dividir el gr치fico en paneles seg칰n la variable categ칩rica `isla` y `fill = sexo` para colorear los violines seg칰n la variable categ칩rica `sexo`.

```{webr}
#| warning: false

ggplot(pinguinos, aes(x = especie, y = masa_corporal_g, fill = sexo)) +
  geom_violin() +
  labs(title = "Boxplots de Masa Corporal",         
       x = "Especie", y = "Masa Corporal (g)") +
  facet_grid(~ isla) 

```





### Resumen

**Comparaci칩n entre `geom_boxplot()` y `geom_violin()`**

| **Caracter칤stica**       | **`geom_boxplot()`**                                      | **`geom_violin()`**                                             |
|--------------------------|----------------------------------------------------------|-----------------------------------------------------------------|
| **Resumen de datos**      | Mediana, cuartiles, valores at칤picos                     | Densidad de los datos, opcionalmente mediana y cuartiles        |
| **Distribuci칩n completa** | No muestra la distribuci칩n completa, solo un resumen     | Muestra la distribuci칩n completa, incluyendo densidades         |
| **Valores at칤picos**      | Los muestra expl칤citamente                               | No se muestran expl칤citamente, pero puedes a침adir un boxplot    |
| **Ventajas**              | Sencillo, compacto, destaca valores at칤picos             | Muestra la forma completa de la distribuci칩n, 칰til para datos complejos |
| **Cu치ndo usar**           | Comparaciones simples entre grupos, detecci칩n de outliers | Comparaci칩n de la distribuci칩n general, especialmente si es multimodal |

***쮺u치ndo usar cada uno?***

**Usar `geom_boxplot()`**:
- **Cuando necesitas un resumen claro y conciso** de la distribuci칩n que incluya la mediana, los cuartiles y los valores at칤picos.
- **Cuando quieres comparar varios grupos** de manera r치pida y eficiente.
- **Cuando est치s interesado en la variabilidad y los valores at칤picos**, porque los boxplots destacan los outliers de forma clara.

**Usar `geom_violin()`**:
- **Cuando te interesa la forma general de la distribuci칩n** de los datos, no solo un resumen.
- **Cuando sospechas que los datos tienen una distribuci칩n compleja**, por ejemplo, si es multimodal (con varios picos) o asim칠trica.
- **Cuando quieres comparar densidades entre grupos** y ver d칩nde se concentra la mayor parte de los datos.
- **Si prefieres una visualizaci칩n m치s detallada y est칠tica** que muestre la forma completa de los datos.


## Ver asociaciones entre 2 variables continuas

- Hasta ahora, hemos visto c칩mo visualizar la distribuci칩n de una variable continua en funci칩n de una variable categ칩rica.
- Ahora, vamos a explorar c칩mo visualizar la relaci칩n entre dos variables continuas, como la masa corporal y la longitud de la aleta de los ping칲inos.
- Un **gr치fico de dispersi칩n** es una herramienta 칰til para visualizar la relaci칩n entre dos variables cuantitativas. En este tipo de gr치fico, cada punto representa una observaci칩n, con una variable en el eje **x** y otra en el eje **y**. Por ejemplo, si tenemos datos de animales, como altura y peso, podemos usar un gr치fico de dispersi칩n para explorar si existe una relaci칩n entre estas dos variables.
- Para crear un gr치fico de dispersi칩n en ggplot, usamos la funci칩n `geom_point()` y mapeamos las variables al eje **x** y **y**. Toma el argumento de size para controlar el tama침o de los puntos y el argumento alpha para controlar la transparencia de los puntos.
- Vamos a explora la relaci칩n entre el **largo de la aleta** y la **masa corporal** de los pinguinos. 

```{webr}
#| warning: false

# Crear un gr치fico de dispersi칩n de masa corporal vs longitud del pico
ggplot(pinguinos, aes(x = masa_corporal_g, y = largo_aleta_mm, color = especie)) +
  geom_point(size = 3, alpha = 0.7) +
  labs(title = "Relaci칩n entre Masa Corporal y Longitud del Pico",
       x = "Masa Corporal (g)",
       y = "Longitud de Aleta (mm)",
       color = "Especie") 

```


- Este gr치fico te permite explorar si existe alguna relaci칩n entre la **masa corporal** y la **longitud de aleta** de los ping칲inos. 
- Podemos ver muy claramente que en todas las especies, la **masa corporal** y la **longitud de aleta** est치n positivamente correlacionadas: a medida que la **masa corporal** aumenta, tambi칠n lo hace la **longitud de aleta**.
- Este concepto ser치 importante cuando exploremos correlaciones y regresiones en lecciones futuras ya que nos permitir치 entender c칩mo dos variables se relacionan entre s칤. 


::: {.callout-tip}
- Una forma f치cil de explorar todas las relaciones entre variables continuas en un conjunto de datos es mediante un **gr치fico de pares**. 
- En un gr치fico de pares, se muestran todas las combinaciones posibles de gr치ficos de dispersi칩n entre las variables continuas en un conjunto de datos. 
- Esto puede ser 칰til para identificar patrones y asociaciones entre las variables, en especial si tienes muchas variables continuas en tus datos.
- Para esto vamos a usar la funci칩n `ggpairs()` del paquete `GGally`. Especificamos las columnas que queremos incluir en el gr치fico de pares con el argumento `columns`. 
- Por el momento no te preocupes por el c칩digo ni los valores de correlaci칩n, simplemente observa c칩mo se ven las relaciones entre las variables en el gr치fico de pares. En lecciones futuras, profundizaremos en c칩mo interpretar estos gr치ficos y c칩mo calcular correlaciones y regresiones.
- A simple vista, 쯣uedes identificar alguna relaci칩n entre las variables en el gr치fico de pares? Observa c칩mo masa corporal y largo de aleta siguen un patr칩n muy claro, donde a medida que una variable aumenta, la otra tambi칠n lo hace. Tambi칠n pon atenci칩n en la relaci칩n de alto_pico y largo_aleta, donde se observan dos grupos claramente diferenciados: uno con pinguinos de menor largo de aleta y mayor alto de pico (Adelia y Barbijo) y otro con pinguinos de mayor largo de aleta y menor alto de pico (Pap칰a). Otras relaciones como masa corporal y alto de pico no parecen tener una relaci칩n tan clara. Sin embargo, recuerda que estas son solo observaciones visuales y no an치lisis formales de correlaci칩n, las cuales veremos m치s adelante.

```{webr}
#| edit: false
#| runbutton: false
#| warning: false

# install.packages("GGally")
library(GGally)

# Gr치fico de pares

ggpairs(pinguinos, 
        columns = c("masa_corporal_g", "largo_pico_mm", "alto_pico_mm", "largo_aleta_mm"), 
        aes(color = especie,  # Color
            alpha = 0.5)) +
  theme_bw() # Tema nuevo

```


- **NOTA 1**: Observa que en este gr치fico especificamos un nuevo tema con `+ theme_bw()`. A pesar de que al inicio especificamos un tema global, podemos cambiar el tema de un gr치fico espec칤fico de esta forma. En este caso, usamos `theme_bw()` porque incorpora una cuadr칤cula de fondo que facilita la visualizaci칩n de los gr치ficos de dispersi칩n. 
- **NOTA 2**: En este gr치fico de pares, cada celda muestra un gr치fico de dispersi칩n entre dos variables. La diagonal principal muestra un histograma de cada variable. Los valores en la parte inferior de cada celda son los coeficientes de correlaci칩n de Pearson entre las dos variables. Estos valores var칤an entre -1 y 1, donde -1 indica una correlaci칩n negativa perfecta, 1 indica una correlaci칩n positiva perfecta y 0 indica que no hay correlaci칩n. En lecciones futuras, veremos c칩mo interpretar estos valores y c칩mo calcular correlaciones y regresiones de manera m치s formal.

:::

## Conteos

- Cuando estamos interesados en visualizar **magnitudes** asociadas a diferentes categor칤as (por ejemplo, las ventas de distintas marcas de autos o las poblaciones de diferentes ciudades), el gr치fico m치s com칰n es el **gr치fico de barras**. 
- Este tipo de gr치fico es ideal para mostrar cantidades asociadas a categor칤as, donde el enfoque principal es la **magnitud** de los valores num칠ricos.
- En un **gr치fico de barras** est치ndar, las alturas de las barras representan la cantidad, como el n칰mero de observaciones en cada categor칤a. 
- Existen varias variaciones de gr치ficos de barras, como las **barras apiladas** o **agrupadas** o el **heatmap** (mapa de calor) que se ver치n al final del curso.
- En **ggplot2**, el gr치fico de barras b치sico se puede crear con `geom_bar()`, que cuenta autom치ticamente las observaciones en cada categor칤a. 
- **NOTA**: Si quieres que las alturas de las barras representen un valor num칠rico espec칤fico (en lugar de contar observaciones), puedes usar `geom_col()`. `geom_col()` lo veremos m치s adelante ya que es un gr치fico muy utilizado en pruebas estad칤sticas que comparan medias. Aqu칤 nos enfocaremos en `geom_bar()` que solo cuenta observaciones.

```{webr}

# Crear un gr치fico de barras que muestre el n칰mero de ping칲inos por especie
ggplot(pinguinos, aes(x = especie)) +
  geom_bar(fill = "skyblue", color = "black") +
  labs(title = "Conteo de Ping칲inos por Especie",
       x = "Especie",
       y = "Conteo") 
```

- **Conteo autom치tico en el eje Y**: `geom_bar()` cuenta autom치ticamente el n칰mero de observaciones (ping칲inos) en cada categor칤a.


::: {.callout-note}

Solo como nota, si en lugar de contar las observaciones, quisieras mostrar un valor num칠rico espec칤fico (por ejemplo, el promedio de la **masa corporal** por especie), usar칤amos `geom_col()`, que mapea expl칤citamente la altura de las barras a un valor num칠rico del dataset. Como se mencion칩, esto se ver치 m치s adelante, pero aqu칤 tienes un ejemplo de c칩mo se ver칤a:

```{webr}
#| edit: false
#| runbutton: false
#| warning: false

library(dplyr)
# Calcular el promedio de masa corporal por especie
pinguinos_summary <- pinguinos %>%
  group_by(especie) %>%
  summarise(masa_promedio = mean(masa_corporal_g, na.rm = TRUE))

# Crear un gr치fico de barras con geom_col()
ggplot(pinguinos_summary, aes(x = especie, y = masa_promedio)) +
  geom_col(fill = "lightgreen", color = "black") +
  labs(title = "Masa Corporal Promedio por Especie",
       x = "Especie",
       y = "Masa Corporal Promedio (g)") 
```

**Comparaci칩n entre `geom_bar()` y `geom_col()`**:
- **`geom_bar()`**: 칔til para mostrar el **conteo** de observaciones en cada categor칤a. Las barras representan el n칰mero de veces que ocurre cada categor칤a. 칔sala cuando simplemente quieras contar cu치ntas observaciones pertenecen a cada categor칤a.
- **`geom_col()`**: Se usa cuando quieres que las alturas de las barras representen un valor num칠rico espec칤fico, como una suma, un promedio u otra medida. 칔sala cuando ya tienes valores calculados (por ejemplo, promedios, sumas) y quieres representarlos con barras.

:::

## EXTRA: Explora las variables de los ping칲inos

Puedes continuar explorando la distribuci칩n de las distintas variables en las diferentes especies de ping칲inos con este gr치fico interactivo. Simplemente selecciona la variable que te interesa y las especie de ping칲ino que quieres explorar.

```{webr}
#| edit: false
#| output: false
#| define:
#|   - do_penguins_density
do_penguins_density <- function(measure, sp) {
  filtered <- pinguinos |> filter(especie == sp)
  ggplot(data = filtered, aes(x = .data[[measure]])) +
  geom_density(aes(fill = especie), alpha = 0.8, position = "identity") +
  labs(title = "Penguins 游냖")
}
```


```{ojs}
//| echo: false
viewof species = Inputs.checkbox(
  [ "Adelia", "Barbijo", "Pap칰a" ],
  { value: ["Adelia", "Barbijo"], label: "Especies" }
);
viewof measure = Inputs.select(
  [ "largo_aleta_mm", "largo_pico_mm", "alto_pico_mm", "masa_corporal_g" ],
  { label: "Variables" }
);
do_penguins_density(measure, species);
```


::: {.callout-tip}

El gr치fico anterior es interactivo y est치 construido con una serie de funciones y  programaci칩n condicional. En este caso, usamos la funci칩n `do_penguins_density` para crear un gr치fico de densidad de una variable seleccionada en funci칩n de una especie de ping칲ino seleccionada. Este tipo de gr치ficos es m치s complejo y no se ver치 en el curso, pero sirve como muestra del poder de R en la visualizaci칩n de datos. Les dejo el c칩digo aqu칤 por si les interesa explorar m치s sobre c칩mo se construy칩 este gr치fico. Aunque ahora puede que no lo entiendan del todo, ver치n que a medida que avancen en el curso, podr치n entender y crear gr치ficos m치s complejos como este. Esta es la base de c칩mo se construyen aplicaciones de an치lisis de datos con R. En un futuro, habr치 un curso de desarrollo de aplicaciones con R.


```r
do_penguins_density <- function(measure, sp) {
  filtered <- pinguinos |> filter(especie == sp)
  ggplot(data = filtered, aes(x = .data[[measure]])) +
  geom_density(aes(fill = especie), alpha = 0.8, position = "identity") +
  labs(title = "Penguins 游냖")
}
```
```ojs
//| echo: false
viewof species = Inputs.checkbox(
  [ "Adelia", "Barbijo", "Pap칰a" ],
  { value: ["Adelia", "Barbijo"], label: "Especies" }
);
viewof measure = Inputs.select(
  [ "largo_aleta_mm", "largo_pico_mm", "alto_pico_mm", "masa_corporal_g" ],
  { label: "Variables" }
);
do_penguins_density(measure, species);
```

:::